<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enter키 줄바꿈 기능 테스트</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        
        textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
        }
        
        .instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        
        .result {
            margin-top: 15px;
            padding: 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 100px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>🎯 Enter키 줄바꿈 기능 테스트</h1>
    
    <div class="test-section">
        <h2>📝 테스트 1: 기본 Textarea</h2>
        <div class="instructions">
            <strong>테스트 방법:</strong>
            <ul>
                <li><strong>Enter키</strong>: 새 줄로 이동 (줄바꿈)</li>
                <li><strong>Shift+Enter</strong>: 기본 브라우저 동작</li>
                <li>아래 텍스트 영역에서 Enter키를 눌러보세요</li>
            </ul>
        </div>
        
        <textarea id="test-textarea-1" placeholder="여기서 Enter키를 테스트해보세요...

💡 Enter: 줄바꿈, Shift+Enter: 기본동작">첫 번째 줄
두 번째 줄
세 번째 줄</textarea>
        
        <div class="result" id="result-1"></div>
    </div>
    
    <div class="test-section">
        <h2>📝 테스트 2: 관리자 모달 스타일 Textarea</h2>
        <div class="instructions">
            <strong>실제 관리자 모달에서 사용되는 스타일과 동일한 textarea입니다.</strong>
        </div>
        
        <textarea id="test-textarea-2" 
                  placeholder="주요 업무 내용을 한 줄씩 입력하세요
예:
민원인 응대
방문·우편·팩스·국민신문고 등 신청경로 확인·안내
민원 신청서 및 구비서류 안내

💡 Enter: 줄바꿈, Shift+Enter: 기본동작"
                  style="width: 100%; height: 120px; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical;">민원인 응대
신청경로 확인
구비서류 안내</textarea>
        
        <div class="result" id="result-2"></div>
    </div>
    
    <div class="test-section">
        <h2>📝 테스트 3: 동적 생성 Textarea</h2>
        <div class="instructions">
            <strong>버튼을 클릭하면 새로운 textarea가 생성됩니다. 새로 생성된 textarea에서도 Enter키 기능이 작동하는지 확인하세요.</strong>
        </div>
        
        <button onclick="createNewTextarea()">새 Textarea 생성</button>
        <div id="dynamic-container"></div>
    </div>
    
    <div class="test-section">
        <h2>📊 현재 상태</h2>
        <div id="status">로드 중...</div>
    </div>
    
    <!-- Utils 스크립트 로드 -->
    <script src="js/logger.js"></script>
    <script src="js/utils.js"></script>
    
    <script>
        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // Enter키 줄바꿈 기능 활성화
            Utils.enableEnterNewlineForAll();
            
            // 실시간 결과 표시
            setupResultDisplays();
            
            // 상태 업데이트
            updateStatus();
        });
        
        function setupResultDisplays() {
            // 각 textarea의 내용 변화를 실시간으로 표시
            document.getElementById('test-textarea-1').addEventListener('input', function() {
                document.getElementById('result-1').textContent = 
                    'Length: ' + this.value.length + ' characters\nLines: ' + (this.value.split('\n').length) + 
                    '\nContent:\n' + this.value;
            });
            
            document.getElementById('test-textarea-2').addEventListener('input', function() {
                document.getElementById('result-2').textContent = 
                    'Length: ' + this.value.length + ' characters\nLines: ' + (this.value.split('\n').length) + 
                    '\nContent:\n' + this.value;
            });
            
            // 초기 내용 표시
            document.getElementById('test-textarea-1').dispatchEvent(new Event('input'));
            document.getElementById('test-textarea-2').dispatchEvent(new Event('input'));
        }
        
        function createNewTextarea() {
            const container = document.getElementById('dynamic-container');
            const count = container.children.length + 1;
            
            const wrapper = document.createElement('div');
            wrapper.style.marginTop = '15px';
            
            const textarea = document.createElement('textarea');
            textarea.id = 'dynamic-textarea-' + count;
            textarea.placeholder = '동적 생성된 Textarea ' + count + '\n\nEnter키로 줄바꿈을 테스트해보세요!\n\n💡 Enter: 줄바꿈, Shift+Enter: 기본동작';
            textarea.value = '동적 생성 테스트 ' + count + '\n새로운 줄\n또 다른 줄';
            textarea.style.cssText = 'width: 100%; height: 100px; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical; background: #fff5f5;';
            
            const result = document.createElement('div');
            result.className = 'result';
            result.id = 'dynamic-result-' + count;
            
            textarea.addEventListener('input', function() {
                result.textContent = 
                    'Length: ' + this.value.length + ' characters\nLines: ' + (this.value.split('\n').length) + 
                    '\nContent:\n' + this.value;
            });
            
            wrapper.appendChild(textarea);
            wrapper.appendChild(result);
            container.appendChild(wrapper);
            
            // 초기 내용 표시
            textarea.dispatchEvent(new Event('input'));
            
            // 새로 생성된 textarea에 포커스
            textarea.focus();
        }
        
        function updateStatus() {
            const status = document.getElementById('status');
            const textareas = document.querySelectorAll('textarea');
            
            status.innerHTML = `
                <strong>✅ Enter키 줄바꿈 기능이 활성화되었습니다!</strong><br>
                <br>
                📊 현재 페이지 정보:<br>
                • 전체 textarea 개수: ${textareas.length}개<br>
                • Utils.enableEnterNewlineForAll() 실행 완료<br>
                • MutationObserver 활성화됨 (새로 생성되는 textarea 자동 처리)<br>
                <br>
                🎯 테스트 방법:<br>
                1. 각 textarea에서 Enter키를 눌러보세요<br>
                2. Shift+Enter 조합도 테스트해보세요<br>
                3. 동적 생성 버튼으로 새 textarea를 만들어 테스트해보세요<br>
                <br>
                ⚠️ 주의사항:<br>
                • Enter키만 누르면 줄바꿈이 됩니다<br>
                • Shift+Enter는 기본 브라우저 동작을 유지합니다<br>
                • 실시간으로 결과가 아래 박스에 표시됩니다
            `;
        }
        
        // 키 이벤트 디버깅 (선택사항)
        document.addEventListener('keydown', function(e) {
            if (e.target.tagName.toLowerCase() === 'textarea' && e.key === 'Enter') {
                console.log('Enter key pressed:', {
                    shiftKey: e.shiftKey,
                    ctrlKey: e.ctrlKey,
                    altKey: e.altKey,
                    defaultPrevented: e.defaultPrevented,
                    targetId: e.target.id
                });
            }
        });
    </script>
</body>
</html>